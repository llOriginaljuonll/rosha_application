{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load tailwind_filters %}

{% block style %}
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <style>
        .accordion-content {
            transition: max-height 0.5s ease-in-out;
            overflow: hidden; /* ซ่อนเนื้อหาที่เกิน */
            max-height: 0; /* เริ่มต้นที่ความสูง 0 */
        }

        .accordion-content.show {
            max-height: 1000px; /* ความสูงที่มากกว่าเนื้อหาจริง */
        }
    </style>
{% endblock style %}

{% block content %}
    <main class="w-4/5 mx-auto space-y-[2rem] pb-[5rem]">

        <section class="h-screen flex flex-col justify-center gap-y-[4rem]">
            <h1 class="text-4xl font-bold uppercase text-center tracking-tight mt-[2rem]">
                {{ audition.name }}
            </h1> 
            <div class="gap-x-[2rem] mx-auto overflow-hidden relative grid grid-cols-5">
                <div class="relative aspect-[3/2] mx-auto col-span-3">
                    <img 
                        src="https://images.unsplash.com/photo-1519682718457-c82ce8296645?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="concert hall" 
                        class="object-cover h-full w-full mx-auto active carousel-item inset-0 opacity-100 transition-opacity duration-1000 ease-in-out">
                    <img 
                        src="https://images.unsplash.com/photo-1531660963020-52ba84d92593?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="concert hall" 
                        class="object-cover h-full w-full mx-auto absolute carousel-item inset-0 opacity-100 transition-opacity duration-1000 ease-in-out">
                    <img 
                        src="https://images.unsplash.com/photo-1651606682103-6725b81d7edd?q=80&w=1632&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="concert hall" 
                        class="object-cover h-full w-full mx-auto absolute carousel-item inset-0 opacity-100 transition-opacity duration-1000 ease-in-out">
                </div>
                <div class="grid grid-cols-2 mb-[5rem]">
                    {% if audition.image %}
                        <button 
                            href="#"
                            data-modal-target="poster-modal"
                            data-modal-toggle="poster-modal"
                            >
                            <img src="{{ audition.image.url }}" class="col-span-1 h-full">
                        </button>

                        <!-- Poster Modal-->
                        {% include "components/poster_modal.html" %}
                    {% endif %}
                    <div class="col-span-1 ps-[5rem]">
                        <h2 class="font-medium tracking-tight text-xl text-center py-2 border-b-2 border-black mb-[2rem]">
                            OTHER CONCERTS
                        </h2>
                        <div class="grid grid-cols-3 gap-[2.5rem]">
                            <div class="bg-rose-100 aspect-[0.8/1]">1</div>
                            <div class="bg-rose-100 aspect-[0.8/1]">1</div>
                            <div class="bg-rose-100 aspect-[0.8/1]">1</div>
                            <div class="bg-rose-100 aspect-[0.8/1]">1</div>
                            <div class="bg-rose-100 aspect-[0.8/1]">1</div>
                            <div class="bg-rose-100 aspect-[0.8/1]">1</div>
                            <div class="bg-rose-100 aspect-[0.8/1]">1</div>
                            <div class="bg-rose-100 aspect-[0.8/1]">1</div>
                        </div>
                    </div>
                </div>

                <div onclick="toggleAccordion('accordion-collapse-body-1')">
                    {% if user.is_authenticated %}
                        <h2 id="accordion-collapse-heading-1">
                            <button type="button"
                                class="flex items-center justify-center gap-[1rem] w-full p-5 font-medium rtl:text-right text-gray-500 border border-b-0 border-gray-200 rounded-t-xl focus:ring-4 focus:ring-gray-200 hover:bg-gray-100"
                                data-accordion-target="#accordion-collapse-body-1" aria-expanded="true"
                                aria-controls="accordion-collapse-body-1">
                                <span>Register for the Audition</span>
                                <svg data-accordion-icon class="w-3 h-3 transition-transform duration-200 ease-in-out" aria-hidden="true"
                                    xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 5 5 1 1 5" />
                                </svg>
                            </button>
                        </h2>
                    {% endif %}
            
                    <div id="accordion-collapse-body-1" class="accordion-content transition-all duration-500 ease-in-out" aria-labelledby="accordion-collapse-heading-1">
                        <form class="border px-10 pt-5 pb-2" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            {{ form|crispy }}
                            <img class="mt-[2rem] w-1/3 h-auto" src="https://lh7-us.googleusercontent.com/tE_P9qKIIm_auJ5DbdkzQfjdQW0qUsO8ASSmpcnVmqhNI0C0bQzs7As1MBeOPCQG8fUnfFpKytoDJeIIeazhilh8n1qDtUfjSHgSgLx7owDRW0FdMMT7OziYlV7Q44zOlqO4bso4Spn3_pmBUMqlzlBf1HL5Mw" alt="qrcode for payment">
                            <div class="flex justify-center items-center mt-10">
                                <button 
                                    type="submit" 
                                    class="w-1/3 my-5 mx-auto text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 font-bold rounded-lg text-md px-5 py-2.5">
                                    Submit
                                </button>
                            </div>
                        </form>
                    </div>
                <div>

    </div>
{% endblock content %}
{% block script %}
    <script>
        var name = "{{ audition.id }}";
        document.getElementById('audition_id').value = name;
        var name = "{{ request.user.id }}";
        document.getElementById('user_id').value = name;
    </script>

    <script>
        function toggleAccordion(itemId) {
            const content = document.getElementById(itemId);
            content.classList.toggle('show');
        }
    </script>
    <script>
        let currentIndex = 0;
        const slides = document.getElementsByClassName('carousel-item');
        const totalSlides = slides.length;

        function showSlide(index) {
            for (let i = 0; i < totalSlides; i++) {
                slides[i].classList.remove('opacity-100');
                slides[i].classList.add('opacity-0');
            }
            slides[index].classList.remove('opacity-0');
            slides[index].classList.add('opacity-100');
        }

        function nextSlide() {
            currentIndex = (currentIndex + 1) % totalSlides;
            showSlide(currentIndex);
        }

        function startCarousel() {
            showSlide(currentIndex);
            setInterval(nextSlide, 7000);
        }

        window.onload = startCarousel;
    </script>
{% endblock script %}